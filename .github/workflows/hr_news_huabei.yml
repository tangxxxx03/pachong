name: HR News Crawler (Sanmao Daily)

on:
  schedule:
    # 每个工作日 北京时间 09:00（UTC+8 → UTC 01:00）
    - cron: "0 1 * * 1-5"
  workflow_dispatch: {}

jobs:
  run:
    runs-on: ubuntu-latest

    env:
      # ---- 你的钉钉机器人（必填）----
      DINGTALK_BASE: "https://oapi.dingtalk.com/robot/send?access_token=9748e4a3fada767f92b94795452f7d4f48d3b690a66d2f3da90a5dc636092918"
      DINGTALK_SECRET: "SEC529f73787a4d78ee297d66d4205b2514038b21fe0c596957c639eb2eb0adebc5"
      # ---- 可选：支持多源 ----
      SRC_HRLOO_URLS: "https://www.hrloo.com/,https://www.hrloo.com/news/hr"
      # ---- 可选：固定抓取某一天 ----
      # HR_TARGET_DATE: "2025-01-15"
      # --------------------------------

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          pip install beautifulsoup4 requests urllib3 backports.zoneinfo --quiet
          pip install -r requirements.txt --quiet || true

      - name: Run hr_news_crawler.py
        run: |
          echo "== 开始执行 hr_news_crawler.py =="
          python hr_news_crawler.py
