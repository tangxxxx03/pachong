name: HR News（大客户群）

on:
  workflow_dispatch: {}
  schedule:
    - cron: "0 1 * * 1-5"   # 工作日 09:00（北京时间）

jobs:
  run:
    runs-on: ubuntu-latest
    timeout-minutes: 30

    env:
      # ========= 业务参数 =========
      HR_TZ: Asia/Shanghai
      HR_ONLY_TODAY: "1"
      HR_MAX_ITEMS: "1"

      SRC_HRLOO_URLS: "https://www.hrloo.com/,https://www.hrloo.com/news/hr"

      HR_FILTER_KEYWORDS: "人力资源,社保,员工,用工,劳动,招聘,工资,缴费"
      HR_REQUIRE_ALL: "0"

      # ========= 钉钉（实验群）=========
      # ⚠️ 这里必须和 GitHub Secrets 名字 100% 一致
      DINGTALK_WEBHOOK: ${{ secrets.SHIYANQUNWEBHOOK }}
      DINGTALK_SECRET:  ${{ secrets.SHIYANQUNSECRET }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Run HR News
        run: |
          echo "执行 hr_news_crawler.py"
          python hr_news_crawler.py
